\documentclass{article}
\input cloze-test-macros-lualatex.tex
\usepackage{cloze}

\catcode`\_=12

\begin{document}
\TestTitleDesc{LuaLa\TeX: macro \string\clozeextend}
{}

\TestComment{Without an option}

Lorem ipsum \cloze[hide]{dolor sit \clozeextend}

\TestSection{extension_count}

\def\TmpExtend#1{\TestComment{[#1]} Lorem ipsum \cloze[show]{dolor sit reprehenderit\clozeextend[#1]}}

\TmpExtend{1}
\TmpExtend{2}
\TmpExtend{3}
\TmpExtend{4}
\TmpExtend{5}
\TmpExtend{6}
\TmpExtend{7}
\TmpExtend{8}
\TmpExtend{9}
\TmpExtend{10}

\TestComment{[10]}

Lorem ipsum \cloze[hide]{dolor sit reprehenderit\clozeextend[10]}

\TestComment{[count=10]}

Lorem ipsum \cloze[hide]{dolor sit reprehenderit\clozeextend[count=10]}

\TestComment{[extension_count=10]}

Lorem ipsum \cloze[hide]{dolor sit reprehenderit\clozeextend[extension_count=10]}

\TestSection{extension_height}

\TestComment{[height=2cm]}

Lorem ipsum \cloze[hide]{dolor sit reprehenderit\clozeextend[10,height=2cm]}

\TestComment{[extension_height=2cm]}

Lorem ipsum \cloze[hide]{dolor sit reprehenderit\clozeextend[10,extension_height=2cm]}

\TestSection{extension_width}

\TestComment{[width=2cm]}

Lorem ipsum \cloze[hide]{dolor sit reprehenderit\clozeextend[10,width=2cm]}

\TestComment{[extension_width=2cm]}

Lorem ipsum \cloze[hide]{dolor sit reprehenderit\clozeextend[10,extension_width=2cm]}

\newpage

\TestComment{Inside a squeezed environment}

\begin{clozespace}[spacing=0.6]
Lorem ipsum \cloze{dolor sit reprehenderit in voluptate velit esse
cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat
cupidatat non proident, sunt in culpa qui officia deserunt mollit anim
id est laborum.reprehenderit in voluptate velit esse cillum dolore eu
fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident,
sunt in culpa qui officia deserunt mollit anim id est
laborum.\clozeextend[100]}
\end{clozespace}

\TestComment{spacing=2}

\begin{clozespace}[spacing=2]
Lorem ipsum \cloze{dolor sit reprehenderit in voluptate velit esse
cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat
cupidatat non proident, sunt in culpa qui officia deserunt mollit anim
id est laborum.reprehenderit in voluptate velit esse cillum dolore eu
fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident,
sunt in culpa qui officia deserunt mollit anim id est
laborum.\clozeextend[100]}
\end{clozespace}
\end{document}
