<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>The cloze package</title>
    <link rel="stylesheet" href="ldoc.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>cloze</h1>


<h2>Contents</h2>
<ul>
<li><a href="#Tables">Tables</a></li>
<li><a href="#Fields">Fields</a></li>
<li><a href="#Node_precessing__nodex_">Node precessing (nodex) </a></li>
<li><a href="#Option_handling">Option handling </a></li>
<li><a href="#Assembly_to_cloze_texts">Assembly to cloze texts </a></li>
<li><a href="#Basic_module_functions">Basic module functions </a></li>
</ul>


<h2>Modules</h2>
<ul class="nowrap">
  <li><strong>cloze</strong></li>
</ul>

</div>

<div id="content">

<h1>Module <code>cloze</code></h1>
<p>Cloze uses <a href="https://github.com/stevedonovan/ldoc">LDoc</a> for the
  source code documentation.</p>
<p><p> The supported tags are described on in
  the <a href="https://github.com/stevedonovan/LDoc/wiki">wiki</a>.</p>

<p> <h3>Naming conventions</h3></p>

<ul>
<li><em>Variable</em> names for <em>nodes</em> are suffixed with <code>_node</code>, for example
<code>head_node</code>.</li>
<li><em>Variable</em> names for <em>lengths</em> (dimensions) are suffixed with
<code>_length</code>, for example <code>width</code>.</li>
</ul>
</p>


<h2><a href="#Tables">Tables</a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#nodex">nodex</a></td>
	<td class="summary"><a href="index.html#nodex">nodex</a> is a abbreviation for <strong>node eXtended</strong>.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#registry">registry</a></td>
	<td class="summary">All values and functions, which are related to the option management,
 are stored in a table called <a href="index.html#registry">registry</a>.</td>
	</tr>
</table>
<h2><a href="#Fields">Fields</a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#registry.user_id">registry.user_id</a></td>
	<td class="summary">I didn&rsquo;t know what value I should take as <a href="index.html#registry.user_id">user_id</a>.</td>
	</tr>
</table>
<h2><a href="#Node_precessing__nodex_">Node precessing (nodex) </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#nodex.create_color">nodex.create_color (option)</a></td>
	<td class="summary"><code>nodex.create_color()</code> is a wrapper for the function
 <code>nodex.create_colorstack()</code>.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#nodex.create_line">nodex.create_line (width)</a></td>
	<td class="summary">Create a rule node, which is used as a line for the cloze texts.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#nodex.insert_list">nodex.insert_list (position, current, list, head_node)</a></td>
	<td class="summary">Insert a <code>list</code> of nodes after or before the <code>current</code>.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#nodex.insert_line">nodex.insert_line (current, width)</a></td>
	<td class="summary">Enclose a rule node (cloze line) with two PDF colorstack whatsits.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#nodex.write_line">nodex.write_line ()</a></td>
	<td class="summary">This function enclozes a rule node with color nodes as it the function
 <a href="index.html#nodex.insert_line">nodex.insert_line</a> does.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#nodex.create_linefil">nodex.create_linefil ()</a></td>
	<td class="summary">This function creates a line which stretchs indefinitely in the
 horizontal direction.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#nodex.write_linefil">nodex.write_linefil ()</a></td>
	<td class="summary">The function <a href="index.html#nodex.write_linefil">nodex.write_linefil</a> surrounds a indefinitely strechable
 line with color whatsits and puts it to \TeX’s ‘current (node) list’.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#create_kern_node">create_kern_node (width)</a></td>
	<td class="summary">This function creates a kern node with a given width.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#insert_strut_into_hlist">insert_strut_into_hlist (hlist_node)</a></td>
	<td class="summary">Add at the beginning of each <code>hlist</code> node list a strut (a invisible
  character).</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#nodex.write_margin">nodex.write_margin ()</a></td>
	<td class="summary">Write kern nodes to the current node list.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#search_hlist">search_hlist (head_node)</a></td>
	<td class="summary">Search for a <code>hlist</code> (subtype <code>line</code>) and nsert a strut node into
 the list if a hlist is found.</td>
	</tr>
</table>
<h2><a href="#Option_handling">Option handling </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#registry.create_marker">registry.create_marker (index)</a></td>
	<td class="summary">We create a user defined whatsit node that can store a number (type
  = 100).</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#registry.write_marker">registry.write_marker (mode, position)</a></td>
	<td class="summary">Write a marker node to TeX&rsquo;s current node list.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#registry.is_marker">registry.is_marker (item)</a></td>
	<td class="summary">This functions checks if the given node <code>item</code> is a marker.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#registry.check_marker">registry.check_marker (item, mode, position)</a></td>
	<td class="summary">This functions tests, whether the given node <code>item</code> is a marker.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#registry.get_marker">registry.get_marker (item, mode, position)</a></td>
	<td class="summary"><a href="index.html#registry.get_marker">registry.get_marker</a> returns the given marker.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#registry.get_marker_data">registry.get_marker_data (item)</a></td>
	<td class="summary"><a href="index.html#registry.get_marker_data">registry.get_marker_data</a> tests whether the node <code>item</code> is a
  marker.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#registry.get_marker_values">registry.get_marker_values (marker)</a></td>
	<td class="summary">First this function saves the associatied values of a marker to the
 local options table.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#registry.remove_marker">registry.remove_marker (marker)</a></td>
	<td class="summary">This function removes a given whatsit marker.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#registry.get_index">registry.get_index ()</a></td>
	<td class="summary"><code>registry.index</code> is a counter.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#registry.set_storage">registry.set_storage (mode, position)</a></td>
	<td class="summary"><code>registry.set_storage()</code> stores the local options in the Lua table
  <code>registry.storage</code>.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#registry.get_storage">registry.get_storage (index)</a></td>
	<td class="summary">The function <code>registry.get_storage()</code> retrieves values which belong
  to a whatsit marker.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#registry.set_option">registry.set_option (key, value)</a></td>
	<td class="summary">This function stores a value <code>value</code> and his associated key <code>key</code>
  either to the global (<code>registry.global_options</code>) or to the local
  (<code>registry.local_options</code>) option table.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#registry.set_is_global">registry.set_is_global (value)</a></td>
	<td class="summary"><code>registry.set_is_global()</code> sets the variable <code>registry.is_global</code> to
 the value <code>value</code>.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#registry.unset_local_options">registry.unset_local_options ()</a></td>
	<td class="summary">This function unsets the local options.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#registry.unset_global_options">registry.unset_global_options ()</a></td>
	<td class="summary"><a href="index.html#registry.unset_global_options">registry.unset_global_options</a> empties the global options storage.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#registry.get_value">registry.get_value (key)</a></td>
	<td class="summary">Retrieve a value from a given key.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#registry.get_value_show">registry.get_value_show ()</a></td>
	<td class="summary">The function <code>registry.get_value_show()</code> returns the boolean value
 <code>true</code> if the option <code>show</code> is true.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#registry.has_value">registry.has_value (value)</a></td>
	<td class="summary">This function tests whether the value <code>value</code> is not empty and has a
 value.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#registry.get_defaults">registry.get_defaults (option)</a></td>
	<td class="summary"><code>registry.get_defaults(option)</code> returns a the default value of the
 given option.</td>
	</tr>
</table>
<h2><a href="#Assembly_to_cloze_texts">Assembly to cloze texts </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#make_basic">make_basic (head_node_input)</a></td>
	<td class="summary">The corresponding LaTeX command to this lua function is <code>\cloze</code>.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#make_single">make_single (start_node, stop_node, parent_node)</a></td>
	<td class="summary">The function <code>make_single()</code> makes one gap.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#search_stop">search_stop (start_node, parent_node)</a></td>
	<td class="summary">Search for a stop marker or make a cloze up to the end of the node
 list.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#continue_cloze">continue_cloze (parent_node)</a></td>
	<td class="summary"></td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#search_start">search_start (head_node, parent_node)</a></td>
	<td class="summary"></td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#make_fix">make_fix (head_node_input)</a></td>
	<td class="summary">The corresponding LaTeX command to this Lua function is <code>\clozefix</code>.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#make_single">make_single (start, stop)</a></td>
	<td class="summary">The function <a href="index.html#make_single">make_single</a> generates a gap of fixed width.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#make_fix_recursion">make_fix_recursion (head_node)</a></td>
	<td class="summary">Function to recurse the node list and search after marker.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#make_par">make_par (head_node)</a></td>
	<td class="summary">The corresponding LaTeX environment to this lua function is
 <code>clozepar</code>.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#register_callback">register_callback (callback_name, func, description)</a></td>
	<td class="summary"></td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#unregister_callback">unregister_callback (callback_name, description)</a></td>
	<td class="summary"></td>
	</tr>
</table>
<h2><a href="#Basic_module_functions">Basic module functions </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#base.register">base.register (mode)</a></td>
	<td class="summary">This function registers the functions <a href="index.html#make_par">make_par</a>, <a href="index.html#make_basic">make_basic</a> and
  <a href="index.html#make_fix">make_fix</a> the Lua callbacks.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#base.unregister">base.unregister (mode)</a></td>
	<td class="summary"><code>base.unregister(mode)</code> deletes the registered functions from the
 Lua callbacks.</td>
	</tr>
</table>

<br/>
<br/>


    <h2 class="section-header "><a name="Tables"></a>Tables</h2>

    <dl class="function">
    <dt>
    <a name = "nodex"></a>
    <strong>nodex</strong>
    </dt>
    <dd>
    <a href="index.html#nodex">nodex</a> is a abbreviation for <strong>node eXtended</strong>.







</dd>
    <dt>
    <a name = "registry"></a>
    <strong>registry</strong>
    </dt>
    <dd>
    All values and functions, which are related to the option management,
 are stored in a table called <a href="index.html#registry">registry</a>.







</dd>
</dl>
    <h2 class="section-header "><a name="Fields"></a>Fields</h2>

    <dl class="function">
    <dt>
    <a name = "registry.user_id"></a>
    <strong>registry.user_id</strong>
    </dt>
    <dd>
    I didn&rsquo;t know what value I should take as <a href="index.html#registry.user_id">user_id</a>.  Therefore I
 took my birthday and transformed it to a large number.







</dd>
</dl>
    <h2 class="section-header "><a name="Node_precessing__nodex_"></a>Node precessing (nodex) </h2>

    <dl class="function">
    <dt>
    <a name = "nodex.create_color"></a>
    <strong>nodex.create_color (option)</strong>
    </dt>
    <dd>
    <code>nodex.create_color()</code> is a wrapper for the function
 <code>nodex.create_colorstack()</code>.  It queries the current values of the
 options <code>linecolor</code> and <code>textcolor</code>. The argument <code>option</code> accepts the
 strings <code>line</code>, <code>text</code> and <code>reset</code>.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">option</span>

        </li>
    </ul>





</dd>
    <dt>
    <a name = "nodex.create_line"></a>
    <strong>nodex.create_line (width)</strong>
    </dt>
    <dd>
    Create a rule node, which is used as a line for the cloze texts.  The
 <code>depth</code> and the <code>height</code> of the rule are calculated form the options
 <code>thickness</code> and <code>distance</code>. The argument <code>width</code> must have the length
 unit <strong>scaled points</strong>.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">width</span>

        </li>
    </ul>





</dd>
    <dt>
    <a name = "nodex.insert_list"></a>
    <strong>nodex.insert_list (position, current, list, head_node)</strong>
    </dt>
    <dd>
    Insert a <code>list</code> of nodes after or before the <code>current</code>.  The <code>head</code>
 argument is optional. In some edge cases it is unfortately necessary.
 if <code>head</code> is omitted the <code>current</code> node is used. The argument
 <code>position</code> can take the values <code>&apos;after&apos;</code> or <code>&apos;before&apos;</code>.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">position</span>

        </li>
        <li><span class="parameter">current</span>

        </li>
        <li><span class="parameter">list</span>

        </li>
        <li><span class="parameter">head_node</span>

        </li>
    </ul>





</dd>
    <dt>
    <a name = "nodex.insert_line"></a>
    <strong>nodex.insert_line (current, width)</strong>
    </dt>
    <dd>
    Enclose a rule node (cloze line) with two PDF colorstack whatsits.
  The first colorstack node dyes the line, the seccond resets the
  color.</p>

<p> <strong>Node list</strong></p>

<p> <table>
 <thead>
   <tr>
     <th><code>color_line_node</code></th>
     <th><code>whatsit</code></th>
     <th><code>pdf_colorstack</code></th>
     <th>Line color</th>
   </tr>
 </thead>
 <tbody>
   <tr>
     <td><code>line_node</code></td>
     <td><code>rule</code></td>
     <td></td>
     <td><code>width</code></td>
   </tr>
   <tr>
     <td><code>color_reset_node</code></td>
     <td><code>whatsit</code></td>
     <td><code>pdf_colorstack</code></td>
     <td>Reset color</td>
   </tr>
 </tbody>
 </table>


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">current</span>

        </li>
        <li><span class="parameter">width</span>

        </li>
    </ul>





</dd>
    <dt>
    <a name = "nodex.write_line"></a>
    <strong>nodex.write_line ()</strong>
    </dt>
    <dd>
    This function enclozes a rule node with color nodes as it the function
 <a href="index.html#nodex.insert_line">nodex.insert_line</a> does.  In contrast to <a href="index.html#nodex.insert_line">nodex.insert_line</a> the three
 nodes are appended to \TeX’s ‘current list’. They are not inserted in
 a node list, which is accessed by a Lua callback.</p>

<p> <strong>Node list</strong></p>

<p> <table>
 <thead>
   <tr>
     <th>-</th>
     <th><code>whatsit</code></th>
     <th><code>pdf_colorstack</code></th>
     <th>Line color</th>
   </tr>
 </thead>
 <tbody>
   <tr>
     <td>-</td>
     <td><code>rule</code></td>
     <td></td>
     <td><code>width</code></td>
   </tr>
   <tr>
     <td>-</td>
     <td><code>whatsit</code></td>
     <td><code>pdf_colorstack</code></td>
     <td>Reset color</td>
   </tr>
 </tbody>
 </table>







</dd>
    <dt>
    <a name = "nodex.create_linefil"></a>
    <strong>nodex.create_linefil ()</strong>
    </dt>
    <dd>
    This function creates a line which stretchs indefinitely in the
 horizontal direction.







</dd>
    <dt>
    <a name = "nodex.write_linefil"></a>
    <strong>nodex.write_linefil ()</strong>
    </dt>
    <dd>
    The function <a href="index.html#nodex.write_linefil">nodex.write_linefil</a> surrounds a indefinitely strechable
 line with color whatsits and puts it to \TeX’s ‘current (node) list’.







</dd>
    <dt>
    <a name = "create_kern_node"></a>
    <strong>create_kern_node (width)</strong>
    </dt>
    <dd>
    This function creates a kern node with a given width.  The argument
 <code>width</code> had to be specified in scaled points.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">width</span>

        </li>
    </ul>





</dd>
    <dt>
    <a name = "insert_strut_into_hlist"></a>
    <strong>insert_strut_into_hlist (hlist_node)</strong>
    </dt>
    <dd>
    Add at the beginning of each <code>hlist</code> node list a strut (a invisible
  character).</p>

<p> Now we can add line, color etc. nodes after the first node of a hlist
 not before - after is much more easier.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">hlist_node</span>
            <span class="types"><span class="type">node</span></span>

        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><span class="type">node</span></span>
        hlist_node</li>
        <li>
           <span class="types"><span class="type">node</span></span>
        strut_node</li>
        <li>
           <span class="types"><span class="type">node</span></span>
        prev_head_node</li>
    </ol>




</dd>
    <dt>
    <a name = "nodex.write_margin"></a>
    <strong>nodex.write_margin ()</strong>
    </dt>
    <dd>
    Write kern nodes to the current node list.  This kern nodes can be used
 to build a margin.







</dd>
    <dt>
    <a name = "search_hlist"></a>
    <strong>search_hlist (head_node)</strong>
    </dt>
    <dd>
    Search for a <code>hlist</code> (subtype <code>line</code>) and nsert a strut node into
 the list if a hlist is found.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">head_node</span>
            <span class="types"><span class="type">node</span></span>
         The head of a node list.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><span class="type">node</span></span>
        hlist_node</li>
        <li>
           <span class="types"><span class="type">node</span></span>
        strut_node</li>
        <li>
           <span class="types"><span class="type">node</span></span>
        prev_head_node</li>
    </ol>




</dd>
</dl>
    <h2 class="section-header has-description"><a name="Option_handling"></a>Option handling </h2>

          <div class="section-description">
          <p> The table <a href="index.html#registry">registry</a> bundels functions that deal with option handling.</p>

<p> <h2>Marker processing (marker)</h2></p>

<p> A marker is a whatsit node of the subtype <code>user_defined</code>. A marker has
 two purposes:</p>

<ul>
<li>Mark the begin and the end of a gap.</li>
<li>Store a index number, that points to a Lua table, which holds
some additional data like the local options.</li>
</ul>

          </div>
    <dl class="function">
    <dt>
    <a name = "registry.create_marker"></a>
    <strong>registry.create_marker (index)</strong>
    </dt>
    <dd>
    We create a user defined whatsit node that can store a number (type
  = 100).</p>

<p> In order to distinguish this node from other user defined whatsit
 nodes we set the <a href="index.html#registry.user_id">user_id</a> to a large number. We call this whatsit
 node a marker. The argument <code>index</code> is a number, which is associated
 to values in the <code>registry.storage</code> table.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">index</span>

        </li>
    </ul>





</dd>
    <dt>
    <a name = "registry.write_marker"></a>
    <strong>registry.write_marker (mode, position)</strong>
    </dt>
    <dd>
    Write a marker node to TeX&rsquo;s current node list.</p>

<p> The argument <code>mode</code> accepts the string values <code>basic</code>, <code>fix</code> and
 <code>par</code>. The argument <code>position</code>. The argument <code>position</code> is either set
 to <code>start</code> or to <code>stop</code>.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">mode</span>

        </li>
        <li><span class="parameter">position</span>

        </li>
    </ul>





</dd>
    <dt>
    <a name = "registry.is_marker"></a>
    <strong>registry.is_marker (item)</strong>
    </dt>
    <dd>
    This functions checks if the given node <code>item</code> is a marker.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">item</span>

        </li>
    </ul>





</dd>
    <dt>
    <a name = "registry.check_marker"></a>
    <strong>registry.check_marker (item, mode, position)</strong>
    </dt>
    <dd>
    This functions tests, whether the given node <code>item</code> is a marker.</p>

<p> The argument <code>item</code> is a node. The argument <code>mode</code> accepts the string
 values <code>basic</code>, <code>fix</code> and <code>par</code>. The argument <code>position</code> is either
 set to <code>start</code> or to <code>stop</code>.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">item</span>

        </li>
        <li><span class="parameter">mode</span>

        </li>
        <li><span class="parameter">position</span>

        </li>
    </ul>





</dd>
    <dt>
    <a name = "registry.get_marker"></a>
    <strong>registry.get_marker (item, mode, position)</strong>
    </dt>
    <dd>
    <a href="index.html#registry.get_marker">registry.get_marker</a> returns the given marker.</p>

<p> The argument <code>item</code> is a node. The argument <code>mode</code> accepts the string
 values <code>basic</code>, <code>fix</code> and <code>par</code>. The argument <code>position</code> is either
 set to <code>start</code> or to <code>stop</code>.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">item</span>

        </li>
        <li><span class="parameter">mode</span>

        </li>
        <li><span class="parameter">position</span>

        </li>
    </ul>





</dd>
    <dt>
    <a name = "registry.get_marker_data"></a>
    <strong>registry.get_marker_data (item)</strong>
    </dt>
    <dd>
    <a href="index.html#registry.get_marker_data">registry.get_marker_data</a> tests whether the node <code>item</code> is a
  marker.</p>

<p> The argument <code>item</code> is a node of unspecified type.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">item</span>

        </li>
    </ul>





</dd>
    <dt>
    <a name = "registry.get_marker_values"></a>
    <strong>registry.get_marker_values (marker)</strong>
    </dt>
    <dd>
    First this function saves the associatied values of a marker to the
 local options table.  Second it returns this values. The argument
 <code>marker</code> is a whatsit node.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">marker</span>

        </li>
    </ul>





</dd>
    <dt>
    <a name = "registry.remove_marker"></a>
    <strong>registry.remove_marker (marker)</strong>
    </dt>
    <dd>
    This function removes a given whatsit marker.</p>

<p> It only deletes a node, if a marker is given.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">marker</span>

        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><span class="type">node</span></span>
        head</li>
        <li>
           <span class="types"><span class="type">node</span></span>
        current</li>
    </ol>




</dd>
    <dt>
    <a name = "registry.get_index"></a>
    <strong>registry.get_index ()</strong>
    </dt>
    <dd>
    <code>registry.index</code> is a counter.  The functions <code>registry.get_index()</code>
 increases the counter by one and then returns it.







</dd>
    <dt>
    <a name = "registry.set_storage"></a>
    <strong>registry.set_storage (mode, position)</strong>
    </dt>
    <dd>
    <code>registry.set_storage()</code> stores the local options in the Lua table
  <code>registry.storage</code>.</p>

<p> It returns a numeric index number. This index number is the key,
 where the local options in the Lua table are stored. The argument
 <code>mode</code> accepts the string values <code>basic</code>, <code>fix</code> and <code>par</code>.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">mode</span>

        </li>
        <li><span class="parameter">position</span>

        </li>
    </ul>





</dd>
    <dt>
    <a name = "registry.get_storage"></a>
    <strong>registry.get_storage (index)</strong>
    </dt>
    <dd>
    The function <code>registry.get_storage()</code> retrieves values which belong
  to a whatsit marker.</p>

<p> The argument <code>index</code> is a numeric value.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">index</span>

        </li>
    </ul>





</dd>
    <dt>
    <a name = "registry.set_option"></a>
    <strong>registry.set_option (key, value)</strong>
    </dt>
    <dd>
    This function stores a value <code>value</code> and his associated key <code>key</code>
  either to the global (<code>registry.global_options</code>) or to the local
  (<code>registry.local_options</code>) option table.</p>

<p> The global boolean variable <code>registry.local_options</code> controls in
 which table the values are stored.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">key</span>

        </li>
        <li><span class="parameter">value</span>

        </li>
    </ul>





</dd>
    <dt>
    <a name = "registry.set_is_global"></a>
    <strong>registry.set_is_global (value)</strong>
    </dt>
    <dd>
    <code>registry.set_is_global()</code> sets the variable <code>registry.is_global</code> to
 the value <code>value</code>.  It is intended, that the variable takes boolean
 values.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">value</span>

        </li>
    </ul>





</dd>
    <dt>
    <a name = "registry.unset_local_options"></a>
    <strong>registry.unset_local_options ()</strong>
    </dt>
    <dd>
    This function unsets the local options.







</dd>
    <dt>
    <a name = "registry.unset_global_options"></a>
    <strong>registry.unset_global_options ()</strong>
    </dt>
    <dd>
    <a href="index.html#registry.unset_global_options">registry.unset_global_options</a> empties the global options storage.







</dd>
    <dt>
    <a name = "registry.get_value"></a>
    <strong>registry.get_value (key)</strong>
    </dt>
    <dd>
    Retrieve a value from a given key.  First search for the value in the
 local options, then in the global options. If both option storages are
 empty, the default value will be returned.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">key</span>

        </li>
    </ul>





</dd>
    <dt>
    <a name = "registry.get_value_show"></a>
    <strong>registry.get_value_show ()</strong>
    </dt>
    <dd>
    The function <code>registry.get_value_show()</code> returns the boolean value
 <code>true</code> if the option <code>show</code> is true.  In contrast to the function
 <code>registry.get_value()</code> it converts the string value `true' to a
 boolean value.







</dd>
    <dt>
    <a name = "registry.has_value"></a>
    <strong>registry.has_value (value)</strong>
    </dt>
    <dd>
    This function tests whether the value <code>value</code> is not empty and has a
 value.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">value</span>

        </li>
    </ul>





</dd>
    <dt>
    <a name = "registry.get_defaults"></a>
    <strong>registry.get_defaults (option)</strong>
    </dt>
    <dd>
    <code>registry.get_defaults(option)</code> returns a the default value of the
 given option.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">option</span>

        </li>
    </ul>





</dd>
</dl>
    <h2 class="section-header "><a name="Assembly_to_cloze_texts"></a>Assembly to cloze texts </h2>

    <dl class="function">
    <dt>
    <a name = "make_basic"></a>
    <strong>make_basic (head_node_input)</strong>
    </dt>
    <dd>
    The corresponding LaTeX command to this lua function is <code>\cloze</code>.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">head_node_input</span>
            <span class="types"><span class="type">node</span></span>
         The head of a node list.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">node</span></span>
        The head of the node list.
    </ol>




</dd>
    <dt>
    <a name = "make_single"></a>
    <strong>make_single (start_node, stop_node, parent_node)</strong>
    </dt>
    <dd>
    The function <code>make_single()</code> makes one gap.  The argument <code>start</code>
 is the node, where the gap begins. The argument <code>stop</code> is the node,
 where the gap ends.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">start_node</span>

        </li>
        <li><span class="parameter">stop_node</span>

        </li>
        <li><span class="parameter">parent_node</span>

        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><span class="type">node</span></span>
        stop_node</li>
        <li>
           <span class="types"><span class="type">node</span></span>
        parent_node</li>
    </ol>




</dd>
    <dt>
    <a name = "search_stop"></a>
    <strong>search_stop (start_node, parent_node)</strong>
    </dt>
    <dd>
    Search for a stop marker or make a cloze up to the end of the node
 list.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">start_node</span>

        </li>
        <li><span class="parameter">parent_node</span>

        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><span class="type">head_node</span></span>
        </li>
        <li>
           <span class="types"><span class="type">parent_node</span></span>
        </li>
    </ol>




</dd>
    <dt>
    <a name = "continue_cloze"></a>
    <strong>continue_cloze (parent_node)</strong>
    </dt>
    <dd>



    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">parent_node</span>

        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><span class="type">head_node</span></span>
        </li>
        <li>
           <span class="types"><span class="type">parent_node</span></span>
        </li>
    </ol>




</dd>
    <dt>
    <a name = "search_start"></a>
    <strong>search_start (head_node, parent_node)</strong>
    </dt>
    <dd>



    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">head_node</span>
            <span class="types"><span class="type">node</span></span>
         The head of a node list.
        </li>
        <li><span class="parameter">parent_node</span>
            <span class="types"><span class="type">node</span></span>
         The parent node
        </li>
    </ul>





</dd>
    <dt>
    <a name = "make_fix"></a>
    <strong>make_fix (head_node_input)</strong>
    </dt>
    <dd>
    The corresponding LaTeX command to this Lua function is <code>\clozefix</code>.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">head_node_input</span>
            <span class="types"><span class="type">node</span></span>
         The head of a node list.
        </li>
    </ul>





</dd>
    <dt>
    <a name = "make_single"></a>
    <strong>make_single (start, stop)</strong>
    </dt>
    <dd>
    The function <a href="index.html#make_single">make_single</a> generates a gap of fixed width.</p>

<p> <strong>Node lists</strong></p>

<p> <strong>Show text:</strong></p>

<p> <table>
 <tbody>
   <tr>
     <td><code>start_node</code></td>
     <td><code>whatsit</code></td>
     <td><code>user_definded</code></td>
     <td><code>index</code></td>
   </tr>
   <tr>
     <td><code>line_node</code></td>
     <td><code>rule</code></td>
     <td></td>
     <td><code>width</code></td>
   </tr>
   <tr>
     <td><code>kern_start_node</code></td>
     <td><code>kern</code></td>
     <td>&amp; Depends on <code>align</code></td>
     <td></td>
   </tr>
   <tr>
     <td><code>color_text_node</code></td>
     <td><code>whatsit</code></td>
     <td><code>pdf_colorstack</code></td>
     <td>Text color</td>
   </tr>
   <tr>
     <td></td>
     <td><code>glyphs</code></td>
     <td>&amp; Text to show</td>
     <td></td>
   </tr>
   <tr>
     <td><code>color_reset_node</code></td>
     <td><code>whatsit</code></td>
     <td><code>pdf_colorstack</code></td>
     <td>Reset color</td>
   </tr>
   <tr>
     <td><code>kern_stop_node</code></td>
     <td><code>kern</code></td>
     <td>&amp; Depends on <code>align</code></td>
     <td></td>
   </tr>
   <tr>
     <td><code>stop_node</code></td>
     <td><code>whatsit</code></td>
     <td><code>user_definded</code></td>
     <td><code>index</code></td>
   </tr>
 </tbody>
 </table></p>

<p> <strong>Hide text:</strong></p>

<p> <table>
 <thead>
   <tr>
     <th><code>start_node</code></th>
     <th><code>whatsit</code></th>
     <th><code>user_definded</code></th>
     <th><code>index</code></th>
   </tr>
 </thead>
 <tbody>
   <tr>
     <td><code>line_node</code></td>
     <td><code>rule</code></td>
     <td></td>
     <td><code>width</code></td>
   </tr>
   <tr>
     <td><code>stop_node</code></td>
     <td><code>whatsit</code></td>
     <td><code>user_definded</code></td>
     <td><code>index</code></td>
   </tr>
 </tbody>
 </table></p>

<p> Make fixed size cloze.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">start</span>
         The node, where the gap begins
        </li>
        <li><span class="parameter">stop</span>
         The node, where the gap ends
        </li>
    </ul>





</dd>
    <dt>
    <a name = "make_fix_recursion"></a>
    <strong>make_fix_recursion (head_node)</strong>
    </dt>
    <dd>
    Function to recurse the node list and search after marker.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">head_node</span>
            <span class="types"><span class="type">node</span></span>
         The head of a node list.
        </li>
    </ul>





</dd>
    <dt>
    <a name = "make_par"></a>
    <strong>make_par (head_node)</strong>
    </dt>
    <dd>
    The corresponding LaTeX environment to this lua function is
 <code>clozepar</code>.</p>

<p> <strong>Node lists</strong></p>

<p> <strong>Show text:</strong></p>

<p> <table>
 <thead>
   <tr>
     <th><code>strut_node</code></th>
     <th><code>kern</code></th>
     <th></th>
     <th>width = 0</th>
   </tr>
 </thead>
 <tbody>
   <tr>
     <td><code>line_node</code></td>
     <td><code>rule</code></td>
     <td></td>
     <td><code>width</code> (Width from hlist)</td>
   </tr>
   <tr>
     <td><code>kern_node</code></td>
     <td><code>kern</code></td>
     <td></td>
     <td><code>-width</code></td>
   </tr>
   <tr>
     <td><code>color_text_node</code></td>
     <td><code>whatsit</code></td>
     <td><code>pdf_colorstack</code></td>
     <td>Text color</td>
   </tr>
   <tr>
     <td></td>
     <td><code>glyphs</code></td>
     <td></td>
     <td>Text to show</td>
   </tr>
   <tr>
     <td><code>tail_node</code></td>
     <td><code>glyph</code></td>
     <td></td>
     <td>Last glyph in hlist</td>
   </tr>
   <tr>
     <td><code>color_reset_node</code></td>
     <td><code>whatsit</code></td>
     <td><code>pdf_colorstack</code></td>
     <td>Reset color</td>
   </tr>
 </tbody>
 </table></p>

<p> <strong>Hide text:</strong></p>

<p> <table>
 <thead>
   <tr>
     <th><code>strut_node</code></th>
     <th><code>kern</code></th>
     <th></th>
     <th>width = 0</th>
   </tr>
 </thead>
 <tbody>
   <tr>
     <td><code>line_node</code></td>
     <td><code>rule</code></td>
     <td></td>
     <td><code>width</code> (Width from hlist)</td>
   </tr>
 </tbody>
 </table>


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">head_node</span>
            <span class="types"><span class="type">node</span></span>
         The head of a node list.
        </li>
    </ul>





</dd>
    <dt>
    <a name = "register_callback"></a>
    <strong>register_callback (callback_name, func, description)</strong>
    </dt>
    <dd>



    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">callback_name</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.2/manual.html#6.4">string</a></span>
         The name of a callback
        </li>
        <li><span class="parameter">func</span>
            <span class="types"><span class="type">function</span></span>
         A function to register for the callback
        </li>
        <li><span class="parameter">description</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.2/manual.html#6.4">string</a></span>
         Only used in LuaLatex
        </li>
    </ul>





</dd>
    <dt>
    <a name = "unregister_callback"></a>
    <strong>unregister_callback (callback_name, description)</strong>
    </dt>
    <dd>



    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">callback_name</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.2/manual.html#6.4">string</a></span>
         The name of a callback
        </li>
        <li><span class="parameter">description</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.2/manual.html#6.4">string</a></span>
         Only used in LuaLatex
        </li>
    </ul>





</dd>
</dl>
    <h2 class="section-header has-description"><a name="Basic_module_functions"></a>Basic module functions </h2>

          <div class="section-description">
           The <code>base</code> table contains functions which are published to the
 <code>cloze.sty</code> file.
          </div>
    <dl class="function">
    <dt>
    <a name = "base.register"></a>
    <strong>base.register (mode)</strong>
    </dt>
    <dd>
    This function registers the functions <a href="index.html#make_par">make_par</a>, <a href="index.html#make_basic">make_basic</a> and
  <a href="index.html#make_fix">make_fix</a> the Lua callbacks.</p>

<p> <a href="index.html#make_par">make_par</a> and <a href="index.html#make_basic">make_basic</a> are registered to the callback
 <code>post_linebreak_filter</code> and <a href="index.html#make_fix">make_fix</a> to the callback
 <code>pre_linebreak_filter</code>. The argument <code>mode</code> accepts the string values
 <code>basic</code>, <code>fix</code> and <code>par</code>. A special treatment is needed for clozes in
 display math mode. The <code>post_linebreak_filter</code> is not called on
 display math formulas. I’m not sure if the <code>pre_output_filter</code> is the
 right choice to capture the display math formulas.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">mode</span>

        </li>
    </ul>





</dd>
    <dt>
    <a name = "base.unregister"></a>
    <strong>base.unregister (mode)</strong>
    </dt>
    <dd>
    <code>base.unregister(mode)</code> deletes the registered functions from the
 Lua callbacks.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">mode</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.2/manual.html#6.4">string</a></span>
         The argument <code>mode</code> accepts the string values
 <code>basic</code>, <code>fix</code> and <code>par</code>.
        </li>
    </ul>





</dd>
</dl>


</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/stevedonovan/LDoc">LDoc 1.4.6</a></i>
<i style="float:right;">Last updated 2020-06-28 14:30:14 </i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
